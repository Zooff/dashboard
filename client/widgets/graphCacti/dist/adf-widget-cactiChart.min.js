!function(t,e){"use strict";function a(t){t.widget("cactiChart",{title:"Graph Cacti",description:"Widget permettant l'affichage de graph provenant de l'outil Cactus/Cacti",templateUrl:"{widgetsPath}/cactiChart/src/view/view.html",controller:"cactiChartController",controllerAs:"graph",reload:!0,resolve:{data:["cactiChartService","config",function(t,e){return t.get(e)}]},edit:{controller:"cactiChartEditController",controllerAs:"graph",templateUrl:"{widgetsPath}/cactiChart/src/edit/edit.html"}})}function i(t,e,a,i){if(a){var r=this;this.config=a.config,this.urlSave=a.url,this.url=a.url,this.listTime=["jour","semaine","mois","ann√©e"],this.timeUnit="jour",r.timeValue=86400,r.firstZoom=!1;var n;this.mousedown=function(t){n=t.offsetX},this.mouseup=function(){var t=$event.offsetX,e=$event.target.offsetWidth,a=(11*e/100).toFixed(0)-1,i=(95*e/100).toFixed(0)-1,l=i-a;r.firstZoom&&(r.timestampEnd=moment().unix(),r.tVal=r.timeValue,r.firstZoom=!1);var o=i-n,c=i-t,d=r.timestampEnd-(o*r.tVal/l).toFixed(0),s=r.timestampEnd-(c*r.tVal/l).toFixed(0);d<s?r.url=r.urlSave+"&graph_start="+d+"&graph_end="+s:r.url=r.urlSave+"&graph_start="+s+"&graph_end="+d,r.timestampEnd=s,r.tVal=s-d}}}function r(t,e,a,i){var r=this;this.config=a,this.graphs=[],this.getGraphs=function(t){return e.get("/standard/cactiGraphId/"+t).then(function(t){r.graphs=t.data})},this.getHost=function(t){return e.get("/standard/cactiHost",{params:{model:t}}).then(function(t){return t.data})}}function n(t,e,a){function i(t){if(t.graphId){var e="https://cactux/graph_image.php?action=zoom&local_graph_id="+t.graphId.id;return{config:t,url:e}}}return{get:i}}angular.module("adf.widget.cactiChart",["adf.provider"]).config(a),a.$inject=["dashboardProvider"],angular.module("adf.widget.cactiChart").run(["$templateCache",function(t){t.put("{widgetsPath}/cactiChart/src/edit/edit.html",'<script type=text/ng-template id=autocomplete.html><a> <span ng-bind-html="match.model.url | uibTypeaheadHighlight:query"></span> | <small ng-bind-html="match.model.desc | uibTypeaheadHighlight:query"></small> </a></script><form role=form><div class=form-group><label class=sr-only for=desc>Description</label> <input type=text id=desc class=form-control ng-model=config.desc placeholder="Enter Description of the data"></div><hr><div><label class=ctm-label>Choix du Serveur</label> <input type=text uib-typeahead="serv as serv.description for serv in graph.getHost($viewValue)" typeahead-min-length=3 ng-model=config.hostId typeahead-on-select=graph.getGraphs(config.hostId.id)></div><div ng-if=graph.graphs.length><label class=ctm-label for=gList>Choix du Graph</label> <input type=text uib-typeahead="g as g.title_cache for g in graph.graphs" typeahead-min-length=0 ng-model=config.graphId></div></form>'),t.put("{widgetsPath}/cactiChart/src/view/view.html",'<div><div ng-hide=graph.url class="alert alert-info" role=alert>Please configure the widget</div><div ng-show=graph.url><div><select ng-options="time in graph.listTime" ng-model=graph.timeUnit></select></div><div><img ng-if=graph.url ng-src={{graph.url}} class=img-responsive draggable=false ondragstart="return false"></div><div><p class=text-center>{{graph.desc}}</p></div></div></div>')}]),angular.module("adf.widget.cactiChart").controller("cactiChartController",i),i.$inject=["$rootScope","$scope","data","cactiChartService"],angular.module("adf.widget.cactiChart").controller("cactiChartEditController",r),r.$inject=["$scope","$http","config","cactiChartService"],angular.module("adf.widget.cactiChart").service("cactiChartService",n),n.$inject=["$q","$http","$parse"]}(window);