!function(e,t){"use strict";function l(e){e.widget("pieChart",{title:"Camembert",description:"Widget permettant l'affichage de Camembert",templateUrl:"{widgetsPath}/pieChart/src/view/view.html",controller:"pieChartController",controllerAs:"graph",reload:!0,resolve:{data:["pieChartService","config",function(e,t){return e.get(t)}]},edit:{controller:"pieChartEditController",controllerAs:"graph",templateUrl:"{widgetsPath}/pieChart/src/edit/edit.html"}})}function a(e,t,l){if(t){this.label=t.label,this.value=t.value,this.type=t.type,this.desc=t.desc;var a;a="doughnut"==this.type?75:0,this.options={elements:{arc:{borderWidth:1,borderColor:"#222222"}},legend:{display:!0,position:"left"},cutoutPercentage:a}}}function r(e,t,l,a){this.config=l,l.datasource={}}function i(e,t,l){function a(e,t){var a,r;t.key=[];for(var i in e[0])t.key.push(i);return t.label||(t.label=t.key[0]),t.value||(t.label=t.key[1]),a=l(t.label),r=l(t.value),s=e.map(function(e){return a(e)}),d=e.map(function(e){return r(e)}),{label:s,value:d,type:t.type,desc:t.desc}}function r(e){return t.get(e.url).then(function(e){return e.data}).then(function(t){return a(t,e)})}function i(e){var t=null;return e.expert?t=o(e):e.datasource&&(e.datasource.selected&&(e.url=e.datasource.selected.url),t=r(e)),t}function o(e){return t.post(n,e).then(function(e){return e.data}).then(function(t){return a(t,e)})}var n="/expert/query",s=[],d=[];return{get:i}}angular.module("adf.widget.pieChart",["adf.provider"]).config(l),l.$inject=["dashboardProvider"],angular.module("adf.widget.pieChart").run(["$templateCache",function(e){e.put("{widgetsPath}/pieChart/src/edit/edit.html",'<script type=text/ng-template id=autocomplete.html><a> <span ng-bind-html="match.model.url | uibTypeaheadHighlight:query"></span> | <small ng-bind-html="match.model.desc | uibTypeaheadHighlight:query"></small> </a></script><form role=form><div class=form-group><label for=sample>Datasource</label><div ng-show=config.url class="alert alert-info text-center">{{config.url}}</div><selecttree model=config.datasource></selecttree></div><div><label>Graph</label></div><div class=form-group><label class=sr-only for=desc>Description</label> <input type=text id=desc class=form-control ng-model=config.desc placeholder=Description></div><div><label>Label</label></div><div class=form-group><label class=sr-only for=label>Label</label> <input type=text id=label class=form-control ng-model=config.label placeholder=Label></div><div><label>Value</label></div><div class=form-group><label class=sr-only for=value>Value</label> <input type=text id=value class=form-control ng-model=config.value placeholder=DonnÃ©es></div><div><label>Type de Graph</label></div><div class=form-group><label class=sr-only for=sample>Chart Type</label><select class=form-control ng-model=config.type><option value=pie>Pie</option><option value=polarArea>PolarArea</option><option value=doughnut>Doughnut</option></select></div><div><label ng-click="isCollapsed = !isCollapsed">Chart Option <span ng-hide=isCollapsed class="glyphicon glyphicon-triangle-bottom" aria-hidden=true></span> <span ng-show=isCollapsed class="glyphicon glyphicon-triangle-top" aria-hidden=true></span></label></div><div ng-show=isCollapsed><div><label>Ok</label></div></div><div><input type=checkbox ng-model=expert> Expert Mode</div><div ng-show=expert><div class=form-group><label class=sr-only for=database>Database</label> <input type=text id=database class=form-control placeholder=Database ng-model=config.database></div><div class=form-group><label class=sr-only for=query>Query</label> <textarea rows=3 id=query class=form-control placeholder=Query ng-model=config.expert></textarea></div></div></form>'),e.put("{widgetsPath}/pieChart/src/view/view.html",'<div><div ng-hide=graph.label class="alert alert-info" role=alert>Please insert a url to the widget configuration</div><div ng-show=graph.label><div><canvas id=graph class=chart-base chart-type=graph.type chart-data=graph.value chart-labels=graph.label chart-options=graph.options></canvas></div><div><p class=text-center>{{graph.desc}}</p></div></div></div>')}]),angular.module("adf.widget.pieChart").controller("pieChartController",a),a.$inject=["$scope","data","pieChartService"],angular.module("adf.widget.pieChart").controller("pieChartEditController",r),r.$inject=["$scope","$http","config","pieChartService"],angular.module("adf.widget.pieChart").service("pieChartService",i),i.$inject=["$q","$http","$parse"]}(window);